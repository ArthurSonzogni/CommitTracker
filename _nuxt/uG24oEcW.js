import{_ as V}from"./S-oeU3K-.js";import{g as B,h as S}from"./DUBobU3j.js";import{f as F,g as P,q as $,h as D,B as O,r as T,o as m,c as h,b as C,a as s,d as y,t as f,j as a,p as j,w as M,F as _,l as w,k}from"./CIIwfncC.js";import{f as I}from"./D2nGpDRe.js";import{_ as R}from"./DlAUqK2U.js";var E={exports:{}};(function(x){(function(){var b={months:["January","February","March","April","May","June","July","August","September","October","November","December"],toUTC:function(i){var t=i?new Date(i):new Date;return t=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds()),t},monthName:function(i){var t,r;return typeof i=="number"?t=i:(r=new Date(i),t=r.getMonth()+1),b.months[t-1]},relativeTime:function(i,t){var r,d,o,e,n,l,g,c,u=[];if(typeof i=="number"?r=i:(n=new Date(i),e=n.getTime(),l=new Date().getTime(),r=(l-e)/1e3*-1),t||(t={}),t.futureSuffix||(t.futureSuffix="from now"),t.pastSuffix||(t.pastSuffix="ago"),t.presentText||(t.presentText="now"),t.returnObject||(t.returnObject=!1),g=r<0,r=Math.abs(r),d={seconds:Math.floor(r%31536e3%86400%3600%60),minutes:Math.floor(r%31536e3%86400%3600/60),hours:Math.floor(r%31536e3%86400/3600),days:Math.floor(r%31536e3/86400),years:Math.floor(r/31536e3),past:g},t.returnObject)return d;if(r===0)return t.presentText;o=d.past?t.pastSuffix:t.futureSuffix,c=!0;function p(N,U){c&&(c=t.allUnits,u.push(N+" "+U+(N>1?"s":"")))}return d.years&&p(d.years,"year"),d.days&&p(d.days,"day"),d.hours&&p(d.hours,"hour"),d.minutes&&p(d.minutes,"minute"),d.seconds&&p(d.seconds,"second"),u.join(", ")+" "+o},prettyPrint:function(i,t){var r,d,o,e,n,l,g,c,u,p;return i?typeof i=="number"&&(i=new Date().setSeconds(i)):i=new Date,t||(t={}),t.showTime||(t.showTime=!1),r=new Date(i),o=r.getDate(),o>3&&o<21?e=o+"th":o%10===1?e=o+"st":o%10===2?e=o+"nd":o%10===3?e=o+"rd":e=o+"th",n=r.getFullYear(),l=this.monthName(r.getMonth()+1),d=l+" "+e+", "+n,c=r.getHours(),u=r.getMinutes(),p=c>=12?"pm":"am",c=c%12?c%12:12,u=u<10?"0"+u:u,g=c+":"+u+" "+p,t.showTime?d+" at "+g:d}};x.exports?x.exports=b:this.humandate=b})()})(E);var J=E.exports;const q=B(J),z={class:"section content"},A={class:"container"},H={class:"title"},L={key:0,class:"grid"},Y=["href"],W={class:"events"},G={class:"event"},K={class:"duration"},Q={key:0,class:"delta"},X={class:"content"},Z={class:"header"},ee={class:"resources"},te=["href"],se={class:"date"},ne=["href"],oe=["href"],re=["href"],ae=F({__name:"index",setup(x){const b=I("$,.0f"),v=P();$();const i=D(v.query.id),t=D({}),r=D([]),d=o=>{const e=[];e.push({icon:"bullhorn",title:"CVE published",date:new Date(o.published)}),o.bug_date&&e.push({icon:"bug-outline",title:"Bug reported",date:new Date(o.bug_date),resources:[{title:`${o.bug}`,url:o.bug}]}),console.log(o);for(const[n,l]of Object.entries(o.version_dates))e.push({icon:"cloud-upload",title:`${n} version deployed.`,date:new Date(l)});for(const n in o.commits){const l=o.commits[n];l.type=="commit"&&e.push({icon:"auto-fix",title:`${l.author.split("@")[0]}@ pushed a fix to ${l.repo}.`,resources:[{title:l.title,url:`https://cr-rev.appspot.com/${n}`}],date:new Date(l.date)})}e.sort((n,l)=>n.date-l.date);for(let n=1;n<e.length;n++)e[n].delta=e[n].date-e[n-1].date;for(let n=1;n<e.length;n++)e[n].absolute_delta=e[n].date-e[0].date;return e};return O(async()=>{const e=await(await fetch("/cve/data.json")).json();let n=null;for(const l of e)if(l.id==i.value){n=l;break}t.value=n,r.value=d(n)}),(o,e)=>{const n=V,l=T("b-tooltip"),g=T("b-tag"),c=T("b-icon");return m(),h("div",null,[C(n),s("section",z,[s("div",A,[s("h2",H,[y(f(a(i))+" ",1),a(t).bug_date?(m(),j(g,{key:1,type:"is-info is-small",class:"ml-2"},{default:M(()=>e[1]||(e[1]=[y(" public ")])),_:1})):(m(),j(g,{key:0,type:"is-danger is-small",class:"ml-2"},{default:M(()=>[C(l,{label:"Bug are opened 14 weeks after being fixed",position:"is-top"},{default:M(()=>e[0]||(e[0]=[y(" Private bug ")])),_:1})]),_:1}))]),a(t).bug?(m(),h("div",L,[e[5]||(e[5]=s("strong",null,"Description",-1)),s("p",null,f(a(t).description),1),a(t).vrp_reward?(m(),h(_,{key:0},[e[2]||(e[2]=s("strong",null,"VRP reward",-1)),s("div",null,f(a(b)(a(t).vrp_reward)),1)],64)):w("",!0),e[6]||(e[6]=s("strong",null,"Bug ",-1)),s("a",{href:a(t).bug},f(a(t).bug),9,Y),a(t).components?(m(),h(_,{key:1},[e[3]||(e[3]=s("strong",null,"Components",-1)),s("div",null,[(m(!0),h(_,null,k(a(t).components,u=>(m(),h("div",null,f(u),1))),256))])],64)):w("",!0),e[7]||(e[7]=s("strong",null,"Severity",-1)),s("div",null,f(a(t).severity),1),a(t).found_in?(m(),h(_,{key:2},[e[4]||(e[4]=s("strong",null,"Found in",-1)),s("div",null,f(a(t).found_in),1)],64)):w("",!0),e[8]||(e[8]=s("strong",null,"Version fixed",-1)),s("div",null,f(a(t).version_fixed),1),e[9]||(e[9]=s("strong",null,"Events",-1)),s("div",W,[(m(!0),h(_,null,k(a(r),u=>(m(),h("div",G,[s("div",K,[u.absolute_delta!=u.delta?(m(),h("p",Q," (+"+f(a(S)(u.delta,{largest:2,units:["y","mo","w","d","h"],round:!0}))+") ",1)):w("",!0),y(" "+f(a(S)(u.absolute_delta,{largest:2,units:["y","mo","w","d","h"],round:!0})),1)]),s("div",X,[s("div",Z,[C(c,{icon:u.icon,size:"is-small"},null,8,["icon"]),y(" "+f(u.title),1)]),(m(!0),h(_,null,k(u.resources,p=>(m(),h("div",ee,[s("a",{href:p.url},f(p.title),9,te)]))),256)),s("div",se,f(a(q).prettyPrint(u.date)),1)])]))),256))]),e[10]||(e[10]=s("strong",null,"Problem",-1)),s("div",null,f(a(t).problem),1),e[11]||(e[11]=s("strong",null,"CWE",-1)),s("a",{href:"https://cwe.mitre.org/data/definitions/"+a(t).cweId+".html"},f(a(t).cweId),9,ne),e[12]||(e[12]=s("strong",null,"Links",-1)),s("div",null,[s("div",null,[s("a",{href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name="+a(i)},"MITRE",8,oe)]),s("div",null,[s("a",{href:"https://nvd.nist.gov/vuln/detail/CVE-"+a(i)},"NVD",8,re)])])])):w("",!0)])])])}}}),me=R(ae,[["__scopeId","data-v-1071d089"]]);export{me as default};
