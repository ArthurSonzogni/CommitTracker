import{_ as V}from"./K_zvSPJA.js";import{g as P}from"./Cpj98o6Y.js";import{h as S}from"./CoyiM7UH.js";import{f as B,g as F,q as $,h as D,D as O,r as T,o as m,c as h,b as C,a as s,d as y,t as f,j as a,p as j,w as k,F as _,l as w,k as M,x as I}from"./BJdbIX9c.js";import{f as R}from"./D2nGpDRe.js";import{_ as z}from"./DlAUqK2U.js";var E={exports:{}};(function(x){(function(){var b={months:["January","February","March","April","May","June","July","August","September","October","November","December"],toUTC:function(i){var t=i?new Date(i):new Date;return t=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds()),t},monthName:function(i){var t,o;return typeof i=="number"?t=i:(o=new Date(i),t=o.getMonth()+1),b.months[t-1]},relativeTime:function(i,t){var o,d,r,e,n,u,g,c,l=[];if(typeof i=="number"?o=i:(n=new Date(i),e=n.getTime(),u=new Date().getTime(),o=(u-e)/1e3*-1),t||(t={}),t.futureSuffix||(t.futureSuffix="from now"),t.pastSuffix||(t.pastSuffix="ago"),t.presentText||(t.presentText="now"),t.returnObject||(t.returnObject=!1),g=o<0,o=Math.abs(o),d={seconds:Math.floor(o%31536e3%86400%3600%60),minutes:Math.floor(o%31536e3%86400%3600/60),hours:Math.floor(o%31536e3%86400/3600),days:Math.floor(o%31536e3/86400),years:Math.floor(o/31536e3),past:g},t.returnObject)return d;if(o===0)return t.presentText;r=d.past?t.pastSuffix:t.futureSuffix,c=!0;function p(N,U){c&&(c=t.allUnits,l.push(N+" "+U+(N>1?"s":"")))}return d.years&&p(d.years,"year"),d.days&&p(d.days,"day"),d.hours&&p(d.hours,"hour"),d.minutes&&p(d.minutes,"minute"),d.seconds&&p(d.seconds,"second"),l.join(", ")+" "+r},prettyPrint:function(i,t){var o,d,r,e,n,u,g,c,l,p;return i?typeof i=="number"&&(i=new Date().setSeconds(i)):i=new Date,t||(t={}),t.showTime||(t.showTime=!1),o=new Date(i),r=o.getDate(),r>3&&r<21?e=r+"th":r%10===1?e=r+"st":r%10===2?e=r+"nd":r%10===3?e=r+"rd":e=r+"th",n=o.getFullYear(),u=this.monthName(o.getMonth()+1),d=u+" "+e+", "+n,c=o.getHours(),l=o.getMinutes(),p=c>=12?"pm":"am",c=c%12?c%12:12,l=l<10?"0"+l:l,g=c+":"+l+" "+p,t.showTime?d+" at "+g:d}};x.exports?x.exports=b:this.humandate=b})()})(E);var J=E.exports;const q=P(J),A={class:"section content"},H={class:"container"},L={class:"title"},Y={key:0,class:"grid"},W=["href"],G={class:"events"},K={class:"duration"},Q={key:0,class:"delta"},X={class:"content"},Z={class:"header"},ee={class:"resources"},te=["href"],se={class:"date"},ne=["href"],re=["href"],oe=["href"],ae=B({__name:"index",setup(x){const b=R("$,.0f"),v=F();$();const i=D(v.query.id),t=D({}),o=D([]),d=r=>{const e=[];e.push({icon:"bullhorn",title:"CVE published",date:new Date(r.published)}),r.bug_date&&e.push({icon:"bug-outline",title:"Bug reported",date:new Date(r.bug_date),resources:[{title:`${r.bug}`,url:r.bug}]}),console.log(r);for(const[n,u]of Object.entries(r.version_dates))e.push({icon:"cloud-upload",title:`${n} version deployed.`,date:new Date(u)});for(const n in r.commits){const u=r.commits[n];u.type=="commit"&&e.push({icon:"auto-fix",title:`${u.author.split("@")[0]}@ pushed a fix to ${u.repo}.`,resources:[{title:u.title,url:`https://cr-rev.appspot.com/${n}`}],date:new Date(u.date)})}e.sort((n,u)=>n.date-u.date),r.bug_date||e.unshift({icon:"lock",title:"Private bug - details will be available 14 weeks after the fix is deployed.",date:new Date(e[0].date-1),blur:!0});for(let n=1;n<e.length;n++)e[n].delta=e[n].date-e[n-1].date;for(let n=1;n<e.length;n++)e[n].absolute_delta=e[n].date-e[0].date;return e};return O(async()=>{const e=await(await fetch("/cve/data.json")).json();let n=null;for(const u of e)if(u.id==i.value){n=u;break}t.value=n,o.value=d(n)}),(r,e)=>{const n=V,u=T("b-tooltip"),g=T("b-tag"),c=T("b-icon");return m(),h("div",null,[C(n),s("section",A,[s("div",H,[s("h2",L,[y(f(a(i))+" ",1),a(t).bug_date?(m(),j(g,{key:1,type:"is-info is-small",class:"ml-2"},{default:k(()=>e[1]||(e[1]=[y(" public ")])),_:1})):(m(),j(g,{key:0,type:"is-danger is-small",class:"ml-2"},{default:k(()=>[C(u,{label:"Bug are opened 14 weeks after being fixed",position:"is-top"},{default:k(()=>e[0]||(e[0]=[y(" Private bug ")])),_:1})]),_:1}))]),a(t).bug?(m(),h("div",Y,[e[5]||(e[5]=s("strong",null,"Description",-1)),s("p",null,f(a(t).description),1),a(t).vrp_reward?(m(),h(_,{key:0},[e[2]||(e[2]=s("strong",null,"VRP reward",-1)),s("div",null,f(a(b)(a(t).vrp_reward)),1)],64)):w("",!0),e[6]||(e[6]=s("strong",null,"Bug ",-1)),s("a",{href:a(t).bug},f(a(t).bug),9,W),a(t).components?(m(),h(_,{key:1},[e[3]||(e[3]=s("strong",null,"Components",-1)),s("div",null,[(m(!0),h(_,null,M(a(t).components,l=>(m(),h("div",null,f(l),1))),256))])],64)):w("",!0),e[7]||(e[7]=s("strong",null,"Severity",-1)),s("div",null,f(a(t).severity),1),a(t).found_in?(m(),h(_,{key:2},[e[4]||(e[4]=s("strong",null,"Found in",-1)),s("div",null,f(a(t).found_in),1)],64)):w("",!0),e[8]||(e[8]=s("strong",null,"Version fixed",-1)),s("div",null,f(a(t).version_fixed),1),e[9]||(e[9]=s("strong",null,"Events",-1)),s("div",G,[(m(!0),h(_,null,M(a(o),l=>(m(),h("div",{class:I(["event",{blur:l.blur}])},[s("div",K,[l.absolute_delta!=l.delta?(m(),h("p",Q," (+"+f(a(S)(l.delta,{largest:2,units:["y","mo","w","d","h"],round:!0}))+") ",1)):w("",!0),y(" "+f(a(S)(l.absolute_delta,{largest:2,units:["y","mo","w","d","h"],round:!0})),1)]),s("div",X,[s("div",Z,[C(c,{icon:l.icon,size:"is-small"},null,8,["icon"]),y(" "+f(l.title),1)]),(m(!0),h(_,null,M(l.resources,p=>(m(),h("div",ee,[s("a",{href:p.url},f(p.title),9,te)]))),256)),s("div",se,f(a(q).prettyPrint(l.date)),1)])],2))),256))]),e[10]||(e[10]=s("strong",null,"Problem",-1)),s("div",null,f(a(t).problem),1),e[11]||(e[11]=s("strong",null,"CWE",-1)),s("a",{href:"https://cwe.mitre.org/data/definitions/"+a(t).cweId+".html"},f(a(t).cweId),9,ne),e[12]||(e[12]=s("strong",null,"Links",-1)),s("div",null,[s("div",null,[s("a",{href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name="+a(i)},"MITRE",8,re)]),s("div",null,[s("a",{href:"https://nvd.nist.gov/vuln/detail/CVE-"+a(i)},"NVD",8,oe)])])])):w("",!0)])])])}}}),ce=z(ae,[["__scopeId","data-v-e627de62"]]);export{ce as default};
