import{_ as kt}from"./S-oeU3K-.js";import{_ as jt}from"./NJxDG96_.js";import{s as p,t as $t}from"./CNzZi2nf.js";import{t as Mt,l as Vt,i as I}from"./Br5iDS7E.js";import{f as Bt,q as Dt,g as Ct,h,i as Ft,r as L,o,c as u,b,a as r,w as j,j as d,v as E,d as f,F as g,l as v,e as gt,t as _,k as C,p as Y}from"./CIIwfncC.js";import{f as vt}from"./D2nGpDRe.js";import{l as W}from"./Dp_3OYB3.js";import{c as Nt}from"./BOzyxcAh.js";import{a as Lt,b as Yt,c as Ht}from"./rlX7cRMw.js";import{_ as zt}from"./DlAUqK2U.js";import"./BeACrgm2.js";import"./DKbKBQE1.js";import"./BnJ91Bvx.js";const Gt={class:"section container sticky"},qt={class:"columns"},Et={class:"column"},Ot={class:"column"},St={class:"section container"},Tt={x:"600",y:"150",class:"current_year_label","font-size":"19","font-weight":"bold",fill:"black","text-anchor":"middle"},Rt={class:"section container"},At={class:"title"},Pt={class:"grid"},Ut={class:"table is-bordered is-striped is-narrow is-hoverable"},It={scope:"col"},Wt={scope:"row"},Jt={key:0},Kt={style:{"white-space":"pre-line",width:"500px"}},Qt={key:0},Xt=Bt({__name:"overview",setup(Zt){vt("+,d");const O=vt("+.1f"),mt=Dt(),J=Ct(),s=h(["High","Critical"]);J.query.severities&&(s.value=J.query.severities.split(",")),Ft(s,()=>{const M=s.value.length===2&&s.value.includes("High")&&s.value.includes("Critical");mt.push({query:{severities:M?void 0:s.value.join(",")}}),lt()});const K=h([]),Q=h(null),X=h(null),Z=h(null),tt=h(null),et=h(null),rt=h(null),ot=h(null),nt=h(null),yt=new Date().getFullYear()-1,ht=new Date().getFullYear(),F=h(0),H=h(0),S=["angle","chromium","dawn","skia","swiftshader","v8","webrtc"],bt=M=>M.severity&&s.value.includes(M.severity)&&M.id>"2020";let st=!0;const lt=async()=>{const t=(await(await fetch("/cve/data.json")).json()).filter(bt),T=e=>{if(!e.description)return"???";for(const n of S)if(n!="chromium"&&e.description.toLowerCase().includes(n))return n;return"chromium"},V=t.map(e=>({...e,project:T(e)})),z=new Map([["Low",0],["Medium",1],["High",2],["Critical",3]]),x=e=>{const n=e.toString();let i=V;i=i.filter(w=>w.id&&w.id.startsWith(n)),i=i.reverse(),i=i.sort((w,U)=>z.get(w.severity)-z.get(U.severity)),i=Object.groupBy(i,w=>w.problem);for(const w in i)i[w]=Object.groupBy(i[w],U=>U.project);return i},m=Array.from(new Set(V.map(e=>{var n;return(n=e.id)==null?void 0:n.slice(0,4)}))).filter(e=>e).sort().reverse().map(e=>parseInt(e)).map(e=>({year:e,cves:x(e)}));K.value=m;for(let e=0;e<m.length;e++){let n=0;Object.values(m[e].cves).forEach(i=>{Object.values(i).forEach(w=>{n+=Object.values(w).length})}),m[e].total=n,e>0&&(m[e-1].total_previous=n)}const D=new Date,l=(D-new Date(`${D.getFullYear()}-01-01`))/(new Date(`${D.getFullYear()+1}-01-01`)-new Date(`${D.getFullYear()}-01-01`)),$=m[0].total/l;F.value=Math.max(m[0].total+.01,Math.round($-1.96*Math.sqrt($))),console.log(F.value),H.value=Math.round($+1.96*Math.sqrt($)),await new Promise(e=>setTimeout(e,50));const y=new Date().getFullYear(),N=new Date(`${y-1}-01-01`),G=new Date(`${y+1}-01-01`);let a=t.filter(e=>e.id>=""+N.getFullYear()).map(e=>new Date(e.published)).filter(e=>e>N).sort((e,n)=>e-n).map((e,n)=>[e,n+1-m[1].total]);a.push([new Date(`${y}-01-01`),0]),a=a.sort((e,n)=>e[0]-n[0]);const R=[a[a.length-1],[new Date(`${y+1}-01-01`),F.value]],A=[a[a.length-1],[new Date(`${y+1}-01-01`),H.value]],it=A[1][1],ut=p(Q.value);ut.attr("width",800),ut.attr("height",400);const c={top:20,right:30,bottom:20,left:30},ct=800-c.left-c.right,dt=400-c.top-c.bottom,q=Mt().domain([new Date(`${y-2}-12-31`),new Date(`${y+1}-01-02`)]).range([0,ct]),k=W().domain([a[0][1],A[1][1]]).range([dt,0]),B=$t().duration(st?0:500).ease(Nt);st=!1;const P=Vt().x(e=>q(e[0])).y(e=>k(e[1]));p(X.value).attr("style","filter: url(#glow);").attr("fill","none").attr("stroke","blue").attr("transform",`translate(${c.left}, ${c.top})`).data([a]).transition(B).attrTween("d",function(e){const n=p(this).attr("d"),i=P(e);return I(n,i)}),p(Z.value).attr("style","filter: url(#glow);").attr("fill","none").attr("stroke","#FFA500").attr("transform",`translate(${c.left}, ${c.top})`).attr("stroke-dasharray","5,5").data([R]).transition().attrTween("d",function(e){const n=p(this).attr("d"),i=P(e);return I(n,i)}),p(tt.value).attr("style","filter: url(#glow);").attr("fill","none").attr("stroke","#FFA500").attr("transform",`translate(${c.left}, ${c.top})`).attr("stroke-dasharray","5,5").data([A]).transition().attrTween("d",function(e){const n=p(this).attr("d"),i=P(e);return I(n,i)});const wt=W().domain([0,m[1].total]).range([k(-m[1].total),k(0)]),xt=W().domain([0,it]).range([k(0),k(it)]),_t=p(et.value),pt=p(rt.value),ft=p(ot.value);_t.transition(B).call(Lt(q)),_t.attr("transform",`translate(${c.left}, ${dt+c.top})`),pt.transition(B).call(Yt(wt)),pt.attr("transform",`translate(${c.left}, ${c.top})`),ft.transition(B).call(Ht(xt)),ft.attr("transform",`translate(${c.left+ct}, ${c.top})`),p(nt.value).transition(B).attr("y1",k(0)).attr("y2",k(0)).attr("x1",q(N)).attr("x2",q(G)).attr("transform",`translate(${c.left}, ${c.top})`),p(".previous_year_label").transition(B).attr("y",k(0)),p(".current_year_label").transition(B).attr("y",k(0)+19*3)};return lt(),(M,t)=>{const T=kt,V=L("b-checkbox-button"),z=L("b-field"),x=L("b-icon"),at=L("b-tooltip"),m=jt,D=L("Lazy");return o(),u("div",null,[b(T),t[22]||(t[22]=r("section",{class:"section container"},[r("h1",{class:"title"},"Chromium Vulnerabilities")],-1)),r("section",Gt,[r("div",qt,[r("div",Et,[b(z,{label:"Severity"},{default:j(()=>[b(V,{modelValue:d(s),"onUpdate:modelValue":t[0]||(t[0]=l=>E(s)?s.value=l:null),"native-value":"Low"},{default:j(()=>t[4]||(t[4]=[f("Low")])),_:1},8,["modelValue"]),b(V,{modelValue:d(s),"onUpdate:modelValue":t[1]||(t[1]=l=>E(s)?s.value=l:null),"native-value":"Medium"},{default:j(()=>t[5]||(t[5]=[f("Medium")])),_:1},8,["modelValue"]),b(V,{modelValue:d(s),"onUpdate:modelValue":t[2]||(t[2]=l=>E(s)?s.value=l:null),"native-value":"High"},{default:j(()=>t[6]||(t[6]=[f("High")])),_:1},8,["modelValue"]),b(V,{modelValue:d(s),"onUpdate:modelValue":t[3]||(t[3]=l=>E(s)?s.value=l:null),"native-value":"Critical"},{default:j(()=>t[7]||(t[7]=[f("Critical")])),_:1},8,["modelValue"])]),_:1})]),r("div",Ot,[d(s).includes("Low")?(o(),u(g,{key:0},[b(x,{type:"is-info",icon:"circle"}),t[8]||(t[8]=f(" Low "))],64)):v("",!0),d(s).includes("Medium")?(o(),u(g,{key:1},[b(x,{type:"is-warning",icon:"circle"}),t[9]||(t[9]=f(" Medium "))],64)):v("",!0),d(s).includes("High")?(o(),u(g,{key:2},[b(x,{type:"is-danger",icon:"circle"}),t[10]||(t[10]=f(" High "))],64)):v("",!0),d(s).includes("Critical")?(o(),u(g,{key:3},[b(x,{icon:"circle"}),t[11]||(t[11]=f(" Critical "))],64)):v("",!0)])])]),r("section",St,[(o(),u("svg",{ref_key:"svg_ref",ref:Q},[r("path",{ref_key:"svg_graph_projection_low_ref",ref:Z},null,512),r("path",{ref_key:"svg_graph_projection_high_ref",ref:tt},null,512),r("path",{ref_key:"svg_graph_ref",ref:X},null,512),r("g",{ref_key:"axis_x_ref",ref:et},null,512),r("g",{ref_key:"axis_y1_ref",ref:rt},null,512),r("g",{ref_key:"axis_y2_ref",ref:ot},null,512),t[12]||(t[12]=gt('<g data-v-84732b2b><rect x="45" y="10" width="10" height="10" fill="blue" data-v-84732b2b></rect><text x="60" y="20" data-v-84732b2b>Historical</text><rect x="45" y="30" width="10" height="10" fill="#FFA500" data-v-84732b2b></rect><text x="60" y="40" data-v-84732b2b>Projection</text></g><line x1="400" x2="400" y1="0" y2="380" stroke="black" stroke-width="1" stroke-dasharray="5,5" data-v-84732b2b></line>',2)),r("line",{ref_key:"svg_split_horizontal_ref",ref:nt,x1:"30",x2:"770",y1:"190",y2:"190",stroke:"black","stroke-width":"1","stroke-dasharray":"5,5"},null,512),r("text",{x:"200",y:"150",class:"previous_year_label","font-size":"19","font-weight":"bold",fill:"black","text-anchor":"middle"},_(yt)),r("text",Tt,_(d(ht)),1),t[13]||(t[13]=gt('<filter id="glow" x="-50%" y="-50%" width="200%" height="200%" data-v-84732b2b><feGaussianBlur stdDeviation="13" result="coloredBlur" data-v-84732b2b></feGaussianBlur><feGaussianBlur stdDeviation="5" result="coloredBlur2" data-v-84732b2b></feGaussianBlur><feGaussianBlur stdDeviation="3" result="coloredBlur3" data-v-84732b2b></feGaussianBlur><feMerge data-v-84732b2b><feMergeNode in="coloredBlur" data-v-84732b2b></feMergeNode><feMergeNode in="coloredBlur2" data-v-84732b2b></feMergeNode><feMergeNode in="coloredBlur2" data-v-84732b2b></feMergeNode><feMergeNode in="SourceGraphic" data-v-84732b2b></feMergeNode></feMerge></filter>',1))],512))]),(o(!0),u(g,null,C(d(K),(l,$)=>(o(),u("section",Rt,[r("h2",At,_(l.year),1),r("div",Pt,[t[17]||(t[17]=r("strong",null,"Total : ",-1)),r("p",null,_(l.total)+" CVEs",1),$>0?(o(),u(g,{key:0},[t[14]||(t[14]=r("strong",null,"Y/Y :",-1)),r("p",null,_(d(O)((l.total-l.total_previous)/l.total*100))+" % ",1)],64)):v("",!0),$===0?(o(),u(g,{key:1},[t[15]||(t[15]=r("strong",null,"Projection :",-1)),f(" [ "+_(d(F))+" CVEs , "+_(d(H))+" CVEs ] ",1)],64)):v("",!0),$===0?(o(),u(g,{key:2},[t[16]||(t[16]=r("strong",null,"Y/Y projection :",-1)),f(" [ "+_(d(O)((d(F)-l.total_previous)/l.total_previous*100))+" % , "+_(d(O)((d(H)-l.total_previous)/l.total_previous*100))+" % ] ",1)],64)):v("",!0)]),t[21]||(t[21]=r("hr",null,null,-1)),b(D,null,{default:j(()=>[r("table",Ut,[r("thead",null,[r("tr",null,[t[18]||(t[18]=r("th",{scope:"col"},null,-1)),(o(),u(g,null,C(S,y=>r("th",It,_(y),1)),64))])]),r("tbody",null,[(o(!0),u(g,null,C(l.cves,(y,N)=>(o(),u("tr",null,[r("th",Wt,_(N),1),(o(),u(g,null,C(S,G=>r("td",null,[y[G]?(o(),u("span",Jt,[(o(!0),u(g,null,C(y[G],a=>(o(),Y(m,{to:`/cve?id=${a.id}`},{default:j(()=>[b(at,{type:"is-light"},{content:j(()=>[r("p",Kt,[r("strong",null,_(a.id),1),f(" - "+_(a.description),1)]),a.vrp_reward?(o(),u("p",Qt,[t[19]||(t[19]=r("strong",null," Reward ",-1)),f(" "+_(a.vrp_reward)+"$ ",1)])):v("",!0),(o(!0),u(g,null,C(a.components,R=>(o(),u("p",null,[t[20]||(t[20]=r("strong",null," Component ",-1)),f(" "+_(R),1)]))),256))]),default:j(()=>[a.severity==="Low"?(o(),Y(x,{key:0,type:"is-info",icon:"circle"})):v("",!0),a.severity==="Medium"?(o(),Y(x,{key:1,type:"is-warning",icon:"circle"})):v("",!0),a.severity==="High"?(o(),Y(x,{key:2,type:"is-danger",icon:"circle"})):v("",!0),a.severity==="Critical"?(o(),Y(x,{key:3,icon:"circle"})):v("",!0)]),_:2},1024)]),_:2},1032,["to"]))),256))])):v("",!0)])),64))]))),256))])])]),_:2},1024)]))),256))])}}}),me=zt(Xt,[["__scopeId","data-v-84732b2b"]]);export{me as default};
