import{_ as V}from"./K_zvSPJA.js";import{_ as R}from"./CH0ThVOt.js";import{_ as q}from"./DISM4ima.js";import{_ as b}from"./D9tz11q0.js";import{f as j,g as C,q as k,s as y,h as g,i as h,D as B,r as M,o as N,c as S,b as m,a as u,j as f,v as x,w as T}from"./BJdbIX9c.js";import"./DlAUqK2U.js";import"./FOedhIC0.js";import"./DkrfxnvH.js";import"./yHBgcFlJ.js";import"./DDtb2nVR.js";import"./E4HCz5LM.js";import"./C5X8qJ2i.js";import"./C7cJQd6b.js";import"./D2nGpDRe.js";const z={class:"section"},A={class:"container"},P={class:"section sticky bottom"},Z=j({__name:"pulse",setup(U){const p=C(),D=k();y([]);const v=y([]),s=g([new Date("2000-01-01"),new Date]);if(p.query.dates)try{s.value=p.query.dates.split(",").map(r=>new Date(r))}catch(r){console.error(r)}const n=g(["chromium"]);p.query.repositories&&(n.value=p.query.repositories.split(","));const _=async()=>{D.push({query:{repositories:n.value.join(","),dates:s.value.map(e=>e.toISOString()).join(",")}});const r=await Promise.all(n.value.map(e=>fetch(`/data/${e}/commits_per_hour.json`))),t=await Promise.all(r.map(e=>e.json()));let l=new Date(t.map(e=>e.startDate).reduce((e,o)=>e<o?e:o));const c=Math.max(...t.map(e=>e.commits.length)),d=t.map(e=>{const o=new Array(c).fill(0),i=c-e.commits.length;for(let a=0;a<e.commits.length;a++)o[a+i]=e.commits[a];return o}).map(e=>e.filter((o,i)=>{const a=new Date(l.getTime()+i*1e3*60*60);return a>=s.value[0]&&a<=s.value[1]}));s.value[0]>l&&(l=s.value[0]),v.value=d.map((e,o)=>({label:n.value[o],values:e.map((i,a)=>({x:new Date(l.getTime()+a*1e3*60*60),y:i}))}))};return h(n,_),h(s,_),B(_),(r,t)=>{const l=V,c=R,w=q,d=b,e=M("b-field");return N(),S("div",null,[m(l),u("section",z,[u("div",A,[t[2]||(t[2]=u("h1",{class:"title"},"Repository commits",-1)),t[3]||(t[3]=u("strong",null,"Repositories:",-1)),m(c,{modelValue:f(n),"onUpdate:modelValue":t[0]||(t[0]=o=>x(n)?n.value=o:null),size:"medium",allowMultiple:!0,allowAll:!0},null,8,["modelValue"]),m(w,{data:f(v)},null,8,["data"])])]),u("section",P,[m(e,{expanded:""},{default:T(()=>[m(d,{modelValue:f(s),"onUpdate:modelValue":t[1]||(t[1]=o=>x(s)?s.value=o:null)},null,8,["modelValue"])]),_:1})])])}}});export{Z as default};
