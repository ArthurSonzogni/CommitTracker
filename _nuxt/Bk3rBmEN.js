import{s as u}from"./DkrfxnvH.js";import{f as B}from"./D2nGpDRe.js";import{b as _}from"./BxPoHLz2.js";import{c as f}from"./BOzyxcAh.js";import{i as C}from"./C5X8qJ2i.js";import{f as A,h as x,i as j,D as q,c as D,a as l,t as L,o as O}from"./BJdbIX9c.js";const R={class:"line"},S={class:"left"},G=A({__name:"BarChart",props:{timeLabel:{type:String,default:""},data:{type:Array},formatter:{type:Function,default:B(",d")}},setup(g){const i=g,m=x(null),h=x(null),y=x(null),w=async()=>{y.value.formatter=i.formatter;const c=[];for(const t of i.data){let e=0;for(const r of t.values)e+=r.value;c.push(e)}let n=0;for(const t of c)n=Math.max(n,t);let d=n;for(const t of i.data)for(const e of t.values)e.value>0&&(d=Math.min(d,e.value));d=Math.max(d,1e-6);const b=t=>{t.transition().duration(e=>450).ease(_).style("width",(e,r)=>70*c[r]/n+"%")},M=t=>{t.transition().duration(450).ease(f).style("flex-grow",e=>e.value===0?0:Math.max(1,e.value/d)).style("background-color",e=>e.color)},k=async t=>{t.transition().duration(e=>350).textTween(function(e,r){const a=c[r],o=this._current;this._current=a;const s=y.value.formatter;if(o===void 0)return v=>s(a);if(o<=1&&a>=1)return v=>s(a);if(o>=1&&a<=1)return v=>s(a);const p=C(o,c[r]);return v=>s(p(v))})};u(h.value).selectAll(".line").data(i.data,t=>t.label).join(t=>{const e=t.append("div");e.classed("line",!0),e.style("filter","blur(4px)").style("height","0px").style("opacity",.3).style("transform","translate(-32px, 0)").transition().duration((s,p)=>450+30*Math.sqrt(p)).ease(_).style("height","24px").style("transform","translate(0px, 0)").style("filter","blur(0px)").transition().duration(s=>450).ease(_).style("filter","none").style("opacity",1).style("filter","none");const r=e.append("div");r.classed("left",!0),r.text(s=>s.label);const a=e.append("div");a.classed("center",!0),b(a);const o=e.append("div");return o.classed("right",!0),o.text(0),o.property("_current",s=>0),k(o),e},t=>{const e=t.select(".center");b(e);const r=t.select(".right");return k(r),t},t=>{t.transition().duration((e,r)=>350).delay((e,r)=>500-30*Math.sqrt(r)).ease(f).style("opacity","0.2").style("filter","blur(3px)").transition().duration((e,r)=>150).ease(f).style("transform","translate(64px, 0)").style("height","0px").style("opacity","0").remove()}).select(".center").selectAll(".repository").data(t=>t.values,t=>t.label).join(t=>{const e=t.append("div");return e.classed("repository",!0).style("flex-grow",0),M(e),e.on("mouseover",function(r,a){const o=u(this).node().getBoundingClientRect(),s=u(m.value).select(".tooltip-inner");u(m.value).transition().duration(200).ease(f).style("opacity",1).style("left",o.left+o.width/2+"px").style("top",o.top+"px");const p=y.value.formatter;s.text(a.label+": "+p(a.value))}),e},t=>(M(t),t),t=>t.transition().duration(450).ease(f).style("flex-grow",0).remove())};return j(()=>i.data,w),q(()=>{u(h.value).on("mouseout",()=>{u(m.value).transition().duration(600).delay(1e3).style("opacity",0)}),y.value={formatter:i.formatter},w()}),(c,n)=>(O(),D("div",null,[l("div",R,[l("div",S,[l("strong",null,L(g.timeLabel),1)]),n[0]||(n[0]=l("div",{class:"right"},[l("strong",null,"# commit")],-1))]),l("div",{ref_key:"histogram",ref:h,class:"histogram"},null,512),l("div",{ref_key:"tooltip",ref:m,class:"tooltip"},n[1]||(n[1]=[l("div",{class:"tooltip-inner"},"Test",-1),l("div",{class:"tooltip-arrow"},null,-1)]),512)]))}});export{G as _};
