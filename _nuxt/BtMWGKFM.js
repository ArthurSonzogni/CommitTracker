import{_ as se}from"./S-oeU3K-.js";import{_ as le}from"./NJxDG96_.js";import{h as K}from"./DUBobU3j.js";import{f as ae,q as re,g as ie,h as k,A as X,i as Z,B as ue,r as D,o as v,c as C,b as m,j as u,p as x,v as g,l as S,a as p,d,w as r,t as y,F as M,k as P,n as de}from"./CIIwfncC.js";import{f as fe}from"./D2nGpDRe.js";import{_ as me}from"./DlAUqK2U.js";const pe={class:"section"},ce={class:"container content"},ve={class:"title"},be={key:0},_e=["value"],ye=["value"],we={class:"container content"},ge={class:"title"},ke={class:"grid"},Ve={class:"cve-description"},he={class:"taglist"},Ie={class:"taglist"},Ce={class:"taglist"},Ue={class:"taglist"},xe={class:"taglist"},Ae={class:"taglist"},$e={key:0,class:"cve-description-text"},je=ae({__name:"list",setup(qe){const z=fe("$,.0f"),ee=new Map([["angle","orange"],["chromium","#121212"],["chromiumos-platform2","blue"],["dawn","#FF5722"],["pdfium","#9C27B0"],["skia","#FFC107"],["v8","red"],["webrtc","#03A9F4"],["swiftshader","#4CAF50"]]),te=re(),U=ie(),E=k(!1),A=k([]),oe=X(()=>{const c=new Set;for(const t of A.value)if(t.components)for(const V of t.components)c.add(V);return Array.from(c).sort()}),ne=X(()=>{const c=new Set;for(const t of A.value){const V=t.published.split("-")[0];c.add(V)}return Array.from(c).sort().reverse()});k([]);const a=k("version"),W=k({}),L=k(0),H=k("n/a"),Y=k("n/a"),N=k(!1);U.query.group_by&&(a.value=U.query.group_by);const _=k(null);U.query.component&&(_.value=U.query.component),_.value=="All"&&(_.value=null);const b=k(null);U.query.date&&(b.value=U.query.date);const B=k(null);U.query.repo&&(B.value=U.query.repo);const $=k(!1);U.query.hide_private&&($.value=U.query.hide_private=="true");const j=k(!0);U.query.show_description&&(j.value=U.query.show_description=="true");const R=()=>{const c={group_by:a.value};_.value&&(c.component=_.value),b.value&&b.value!="All"&&(c.date=b.value),B.value&&(c.repo=B.value),$.value&&(c.hide_private="true"),j.value||(c.show_description="false"),te.push({query:c})};Z([a,_,B,b,$,j],R);const G=new Map([[119,"Improper Restriction of Operations within the Bounds of a Memory Buffer"],[120,"Buffer overflow"],[122,"Heap-based Buffer Overflow"],[125,"Out-of-bounds Read"],[1284,"Improper Validation of Specified Quantity in Input"],[1287,"Improper Validation of Specified Type of Input"],[190,"Integer Overflow or Wraparound"],[20,"Improper Input Validation"],[285,"Improper Authorization"],[290,"Authentication Bypass by Spoofing"],[303,"Incorrect Implementation of Authentication Algorithm"],[345,"Insufficient Verification of Data Authenticity"],[346,"Origin Validation Error"],[358,"Improperly Implemented Security Check for Standard"],[362,"Race condition"],[366,"Race Condition within a Thread"],[374,"Passing Mutable Objects to an Untrusted Method"],[416,"Use After Free"],[451,"User Interface (UI) Misrepresentation of Critical Information"],[457,"Use of Uninitialized Variable"],[472,"External Control of Assumed-Immutable Web Parameter"],[474,"Use of Function with Inconsistent Implementations"],[691,"Insufficient Control Flow Management"],[787,"Out-of-bounds Write"],[79,"Cross-site scripting"],[807,"Reliance on Untrusted Inputs in a Security Decision"],[843,"Type confusion"],[863,"Incorrect Authorization"],[94,"Improper Control of Generation of Code (‘Code Injection’)"]]);ue(async()=>{const c=await fetch("/cve/data.json");A.value=await c.json(),L.value=Object.keys(A.value).length;const t=A.value.reduce((w,O)=>Math.max(w,new Date(O.published).getTime()),0);H.value=K(Date.now()-t,{largest:2,round:!0,units:["d"]});const V=A.value.filter(w=>w.bug_date).reduce((w,O)=>Math.max(w,new Date(O.bug_date).getTime()),0);Y.value=K(Date.now()-V,{largest:2,round:!0,units:["d"]})});const F=(c,t)=>{const V=[];for(const w of c)t(w)&&V.push(w);for(const w of c)t(w)||V.push(w);return V};return Z([A,a,_,b,$,j],async()=>{var T;N.value=!0;for(let e=0;e<5;e++)await new Promise(o=>{const l=requestAnimationFrame(()=>{cancelAnimationFrame(l),o()})});let c=new Date("2000-01-01"),t=new Date("2030-01-01");const V=/^\d{4}$/,w=/^\d{4}Q\d$/,O=/^\d{4}M\d{2}$/;if(b.value&&b.value!="All"){if(V.test(b.value))c=new Date(`${b.value}-01-01`),t=new Date(`${b.value}-12-31`);else if(w.test(b.value)){const e=b.value.substring(0,4),l=(b.value.substring(5,6)-1)*3+1;c=new Date(`${e}-${l}-01`),t=new Date(`${e}-${l+2}-31`)}else if(O.test(b.value)){const e=b.value.substring(0,4),o=b.value.substring(5,7);c=new Date(`${e}-${o}-01`),t=new Date(`${e}-${o}-31`)}}const h=A.value.filter(e=>{const o=new Date(e.published);if(_.value){let l=!1;for(const s of e.components||[])if(s.startsWith(_.value)){l=!0;break}if(!l)return!1}if(B.value){let l=!1;for(const s in e.commits)if(e.commits[s].repo==B.value){l=!0;break}if(!l)return!1}return!($.value&&!e.bug_date||o<c||o>t)});let n={},i=[];switch(a.value){case"version":for(const e of h){const o=e.version_fixed||"unknown";n[o]||(n[o]=[]),n[o].push(e)}break;case"version_major":for(const e of h){const o=((T=e.version_fixed)==null?void 0:T.split(".")[0])||"unknown";n[o]||(n[o]=[]),n[o].push(e)}break;case"year":for(const e of h){const o=e.published.split("-")[0];n[o]||(n[o]=[]),n[o].push(e)}break;case"month":for(const e of h){const o=e.published.split("-").slice(0,2).join("-");n[o]||(n[o]=[]),n[o].push(e)}break;case"vrp_reward":for(const e of h){const o=e.vrp_reward?`${z(e.vrp_reward)}`:"unknown";n[o]||(n[o]=[]),n[o].push(e)}break;case"severity":for(const e of h){const o=e.severity||"unknown";n[o]||(n[o]=[]),n[o].push(e)}break;case"component":for(const e of h){if(!e.components){n["<Private bug>"]||(n["<Private bug>"]=[]),n["<Private bug>"].push(e);continue}for(const o of e.components)_.value&&!o.startsWith(_.value)||(n[o]||(n[o]=[]),n[o].push(e))}break;case"cwe":for(const e of h){const o=e.cweId?`${e.cweId} - ${G.get(parseInt(e.cweId))}`:"n/a";n[o]||(n[o]=[]),n[o].push(e)}break;case"authors":for(const e of h){if(!e.commits)continue;const o=new Set;for(const l in e.commits){const s=e.commits[l];if(s.type!="commit")continue;const f=s.author.split("@")[0]+"@";o.add(f)}for(const l of o)n[l]||(n[l]=[]),n[l].push(e)}break;case"reviewers":for(const e of h){if(!e.commits)continue;const o=new Set;for(const l in e.commits){const s=e.commits[l];if(s.type=="commit")for(const f of s.reviewers)o.add(f.split("@")[0]+"@")}for(const l of o)n[l]||(n[l]=[]),n[l].push(e)}break}for(const e in n){const o=n[e];for(const l of o){const s=new Set;for(const f in l.commits){const I=l.commits[f];I.type=="commit"&&s.add(I.repo)}l.repos=Array.from(s)}}for(const e in n){const o=n[e];let l=0;const s=new Set;for(const f of o){l+=parseInt(f.vrp_reward)||0;for(const I of f.repos)s.add(I)}n[e].total_reward=l,n[e].repos=Array.from(s).sort()}switch(a.value){case"version":i=Object.keys(n).sort((e,o)=>{const l=e.split("."),s=o.split("."),f=l.every(q=>!isNaN(q)),I=s.every(q=>!isNaN(q));if(f&&!I)return-1;if(!f&&I)return 1;if(!f&&!I)return e.localeCompare(o);for(let q=0;q<Math.min(l.length,s.length);q++){const Q=parseInt(l[q]),J=parseInt(s[q]);if(Q!=J)return J-Q}return o-e});break;case"version_major":case"year":i=Object.keys(n).sort((e,o)=>parseInt(o)-parseInt(e)),i=F(i,e=>!isNaN(e));break;case"month":i=Object.keys(n).sort().reverse(),i=F(i,e=>!e.startsWith("unknown"));break;case"vrp_reward":i=Object.keys(n).sort((e,o)=>{const l=e.substring(1).replace(",",""),s=o.substring(1).replace(",","");return parseInt(s)-parseInt(l)}),i=F(i,e=>e!="$NaN"&&e!="unknown");break;case"severity":i=Object.keys(n).sort((e,o)=>e.localeCompare(o)),i=["Critical","High","Medium","Low","unknown"];break;case"component":i=Object.keys(n).sort((e,o)=>e.localeCompare(o)),i=F(i,e=>e!="<Private bug>");break;case"cwe":i=Object.keys(n).sort((e,o)=>e.localeCompare(o)),i=F(i,e=>e!="unknown");break;case"authors":case"reviewers":i=Object.keys(n).sort((e,o)=>e.localeCompare(o)),i=F(i,e=>e!="unknown");break}N.value=!1,W.value=i.map(e=>{var o;return{key:e,cves:((o=n[e])==null?void 0:o.reverse())||[]}})}),(c,t)=>{const V=se,w=D("b-loading"),O=D("b-button"),h=D("b-select"),n=D("b-field"),i=D("b-tag"),T=D("b-switch"),e=D("b-radio-button"),o=D("b-taglist"),l=le;return v(),C("div",null,[m(V),u(N)?(v(),x(w,{key:0,modelValue:u(N),"onUpdate:modelValue":t[0]||(t[0]=s=>g(N)?N.value=s:null),"is-full-page":!0},null,8,["modelValue"])):S("",!0),p("section",pe,[p("div",ce,[p("h1",ve,[t[18]||(t[18]=d(" Chromium CVEs ")),m(O,{class:"ml-4",onClick:t[1]||(t[1]=s=>E.value=!u(E)),type:u(E)?"":"is-info"},{default:r(()=>t[17]||(t[17]=[d(" Readme ")])),_:1},8,["type"])]),u(E)?(v(),C("div",be,[t[22]||(t[22]=p("p",null," The list of publicly known vulnerabilities in the Chromium project. This only includes the vulnerabilities that have been assigned a CVE number. Internally found vulnerabilities are not listed here. Bug are usually made public 90 days after they have been fixed. ",-1)),p("ul",null,[p("li",null,[p("strong",null,y(u(L))+" CVEs",1),t[19]||(t[19]=d(" in the database."))]),p("li",null,[t[20]||(t[20]=d("Latest published ")),p("strong",null,y(u(H))+" ago.",1)]),p("li",null,[t[21]||(t[21]=d("Bugs are usually made public 90 days after they have been fixed. Currently the latest public bug was published ")),p("strong",null,y(u(Y))+" ago.",1)])]),t[23]||(t[23]=p("div",{style:{"border-bottom":"1px solid #ccc","margin-bottom":"1em"}},null,-1))])):S("",!0),m(n,null,{default:r(()=>[m(n,{label:"Year"},{default:r(()=>[m(h,{modelValue:u(b),"onUpdate:modelValue":t[2]||(t[2]=s=>g(b)?b.value=s:null),placeholder:"Year",onChange:R},{default:r(()=>[t[24]||(t[24]=p("option",{value:"All"},"All",-1)),(v(!0),C(M,null,P(u(ne),s=>(v(),C("option",{key:s,value:s},y(s),9,_e))),128))]),_:1},8,["modelValue"])]),_:1}),u(_)?(v(),x(n,{key:1,label:"Component",class:"ml-2"},{default:r(()=>[m(i,{closable:"",size:"is-large",onClose:t[4]||(t[4]=s=>_.value=null)},{default:r(()=>[d(y(u(_)),1)]),_:1})]),_:1})):(v(),x(n,{key:0,label:"Component",class:"ml-2"},{default:r(()=>[m(h,{modelValue:u(_),"onUpdate:modelValue":t[3]||(t[3]=s=>g(_)?_.value=s:null),placeholder:"Component",onChange:R},{default:r(()=>[(v(!0),C(M,null,P(u(oe),s=>(v(),C("option",{key:s,value:s},y(s),9,ye))),128))]),_:1},8,["modelValue"])]),_:1})),m(n,{label:"Private bugs",class:"ml-2"},{default:r(()=>[m(T,{modelValue:u($),"onUpdate:modelValue":t[5]||(t[5]=s=>g($)?$.value=s:null),onChange:R},{default:r(()=>t[25]||(t[25]=[d("Hide")])),_:1},8,["modelValue"])]),_:1}),m(n,{label:"Description",class:"ml-2"},{default:r(()=>[m(T,{modelValue:u(j),"onUpdate:modelValue":t[6]||(t[6]=s=>g(j)?j.value=s:null),onChange:R},{default:r(()=>t[26]||(t[26]=[d("Show")])),_:1},8,["modelValue"])]),_:1})]),_:1}),m(n,{label:"Group by"},{default:r(()=>[m(e,{modelValue:u(a),"onUpdate:modelValue":t[7]||(t[7]=s=>g(a)?a.value=s:null),"native-value":"version"},{default:r(()=>t[27]||(t[27]=[d("Version")])),_:1},8,["modelValue"]),m(e,{modelValue:u(a),"onUpdate:modelValue":t[8]||(t[8]=s=>g(a)?a.value=s:null),"native-value":"version_major"},{default:r(()=>t[28]||(t[28]=[d("Version major")])),_:1},8,["modelValue"]),m(e,{modelValue:u(a),"onUpdate:modelValue":t[9]||(t[9]=s=>g(a)?a.value=s:null),"native-value":"year"},{default:r(()=>t[29]||(t[29]=[d("Year")])),_:1},8,["modelValue"]),m(e,{modelValue:u(a),"onUpdate:modelValue":t[10]||(t[10]=s=>g(a)?a.value=s:null),"native-value":"month"},{default:r(()=>t[30]||(t[30]=[d("Month")])),_:1},8,["modelValue"]),m(e,{modelValue:u(a),"onUpdate:modelValue":t[11]||(t[11]=s=>g(a)?a.value=s:null),"native-value":"vrp_reward"},{default:r(()=>t[31]||(t[31]=[d("Reward")])),_:1},8,["modelValue"]),m(e,{modelValue:u(a),"onUpdate:modelValue":t[12]||(t[12]=s=>g(a)?a.value=s:null),"native-value":"severity"},{default:r(()=>t[32]||(t[32]=[d("Severity")])),_:1},8,["modelValue"]),m(e,{modelValue:u(a),"onUpdate:modelValue":t[13]||(t[13]=s=>g(a)?a.value=s:null),"native-value":"component"},{default:r(()=>t[33]||(t[33]=[d("Component")])),_:1},8,["modelValue"]),m(e,{modelValue:u(a),"onUpdate:modelValue":t[14]||(t[14]=s=>g(a)?a.value=s:null),"native-value":"cwe"},{default:r(()=>t[34]||(t[34]=[d("CWE")])),_:1},8,["modelValue"]),m(e,{modelValue:u(a),"onUpdate:modelValue":t[15]||(t[15]=s=>g(a)?a.value=s:null),"native-value":"authors"},{default:r(()=>t[35]||(t[35]=[d("Authors")])),_:1},8,["modelValue"]),m(e,{modelValue:u(a),"onUpdate:modelValue":t[16]||(t[16]=s=>g(a)?a.value=s:null),"native-value":"reviewers"},{default:r(()=>t[36]||(t[36]=[d("Reviewers")])),_:1},8,["modelValue"])]),_:1})])]),(v(!0),C(M,null,P(u(W),s=>(v(),C("section",{class:"section",key:s.key},[p("div",we,[p("h3",ge,[d(y(s.key)+" ",1),m(o,{attached:"",style:{display:"inline-block"},class:"mr-2 is-pulled-right"},{default:r(()=>[m(i,{type:"is-danger is-medium",style:{"background-color":"black"}},{default:r(()=>[d(y(u(z)(s.cves.total_reward))+"$ ",1)]),_:2},1024),m(i,{type:"is-info is-medium"},{default:r(()=>[d(y(s.cves.length)+" CVEs ",1)]),_:2},1024)]),_:2},1024)]),p("div",ke,[(v(!0),C(M,null,P(s.cves,f=>(v(),C(M,null,[m(l,{to:"/cve?id="+f.id,class:"cve-link"},{default:r(()=>[d(y(f.id),1)]),_:2},1032,["to"]),p("div",Ve,[p("div",he,[f.bug_date?S("",!0):(v(),x(i,{key:0,type:"is-danger is-small"},{default:r(()=>t[37]||(t[37]=[d(" Private bug ")])),_:1}))]),p("div",Ie,[f.vrp_reward?(v(),x(i,{key:0,type:"is-info is-small"},{default:r(()=>[d(y(f.vrp_reward)+"$ ",1)]),_:2},1024)):S("",!0)]),p("div",Ce,[(v(!0),C(M,null,P(f.repos,I=>(v(),x(i,{class:"ml-2",style:de({backgroundColor:u(ee).get(I)||"black",color:"white"})},{default:r(()=>[d(y(I),1)]),_:2},1032,["style"]))),256))]),p("div",Ue,[f.cweId?(v(),x(i,{key:0,class:"ml-2"},{default:r(()=>[d(y(f.cweId)+" - "+y(u(G).get(parseInt(f.cweId))),1)]),_:2},1024)):S("",!0)]),p("div",xe,[f.severity?(v(),x(i,{key:0,class:"ml-2",type:"is-danger"},{default:r(()=>[d(y(f.severity),1)]),_:2},1024)):S("",!0)]),p("div",Ae,[(v(!0),C(M,null,P(f.components,I=>(v(),x(i,{class:"ml-2",type:"is-warning"},{default:r(()=>[d(y(I),1)]),_:2},1024))),256))]),t[38]||(t[38]=p("br",null,null,-1)),u(j)?(v(),C("span",$e,y(f.description),1)):S("",!0)])],64))),256))])])]))),128))])}}}),Pe=me(je,[["__scopeId","data-v-eb9a8f1d"]]);export{Pe as default};
