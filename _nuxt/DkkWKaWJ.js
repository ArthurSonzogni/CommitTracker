import{t as P,l as C,a as V,i as W}from"./BJcRDRUM.js";import{s as d}from"./DkrfxnvH.js";import{f as X,S as I,h as y,A as E,D as R,i as Z,o as j,c as z,a as g,e as q}from"./BJdbIX9c.js";import{l as J,e as K}from"./E4HCz5LM.js";import{a as Q,b as U}from"./rlX7cRMw.js";import{p as Y}from"./Drloq0xg.js";import{_ as tt}from"./DlAUqK2U.js";function et(t,n){let e,o;for(const r of t)r!=null&&(e===void 0?r>=r&&(e=o=r):(e>r&&(e=r),o<r&&(o=r)));return[e,o]}function at(t,n){let e;if(n===void 0)for(const o of t)o!=null&&(e<o||e===void 0&&o>=o)&&(e=o);else{let o=-1;for(let r of t)(r=n(r,++o,t))!=null&&(e<r||e===void 0&&r>=r)&&(e=r)}return e}function B(t){return t<0?-1:1}function L(t,n,e){var o=t._x1-t._x0,r=n-t._x1,f=(t._y1-t._y0)/(o||r<0&&-0),p=(e-t._y1)/(r||o<0&&-0),h=(f*r+p*o)/(o+r);return(B(f)+B(p))*Math.min(Math.abs(f),Math.abs(p),.5*Math.abs(h))||0}function F(t,n){var e=t._x1-t._x0;return e?(3*(t._y1-t._y0)/e-n)/2:n}function $(t,n,e){var o=t._x0,r=t._y0,f=t._x1,p=t._y1,h=(f-o)/3;t._context.bezierCurveTo(o+h,r+h*n,f-h,p-h*e,f,p)}function w(t){this._context=t}w.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:$(this,this._t0,F(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var e=NaN;if(t=+t,n=+n,!(t===this._x1&&n===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,$(this,F(this,e=L(this,t,n)),e);break;default:$(this,this._t0,e=L(this,t,n));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=e}}};Object.create(w.prototype).point=function(t,n){w.prototype.point.call(this,n,t)};function nt(t){return new w(t)}const rt=X({__name:"LineChart",props:{data:{type:Array},formatter:{type:Function,default:t=>""+t}},setup(t){const{$color:n}=I(),e=y(null),o=y(null),r=y(null),f=y(null),p=y(null),h=y(null),_=t,G=E(()=>et(_.data.map(i=>i.values).flat().map(i=>i.x))),H=E(()=>[0,at(_.data.map(i=>i.values).flat().map(i=>i.y))]),M=()=>{var D,S;const i={top:10,right:30,bottom:30,left:60},k=((D=e.value)==null?void 0:D.clientWidth)-i.left-i.right||0,N=((S=e.value)==null?void 0:S.clientHeight)-i.top-i.bottom||0;d(f.value).attr("transform",`translate(${i.left}, ${i.top})`),d(o.value).attr("transform",`translate(${i.left}, ${i.top+N})`),d(r.value).attr("transform",`translate(${i.left}, ${i.top})`);const v=P().range([0,k]).domain(G.value),b=J().range([N,0]).domain(H.value);d(o.value).transition().duration(500).call(Q(v).ticks(7)),d(r.value).transition().duration(500).call(U(b));const O=_.data.reduce((a,l)=>Math.max(a,l.values.length),0),A=C().x(a=>v(a.x)).y(a=>b(a.y)).curve(O<400?nt:V),T=C().x(a=>v(a.x)).y(a=>b(0));d(e.value).on("pointerenter pointermove",a=>{const l=K(s=>s.x).left,u=v.invert(Y(a)[0]-i.left),m=_.data.map(s=>{const c=l(s.values,u);return c<=0||c>=s.values.length?null:{label:s.label,x:s.values[c].x,y:s.values[c].y}}).filter(s=>s!==null);d(p.value).selectAll(".tooltipData").data(m,s=>s.label).join(s=>{const c=s.append("g").attr("class","tooltipData").attr("transform",x=>`translate(${v(x.x)}, ${b(x.y)}`);return c.attr("opacity",0).transition().duration(300).attr("opacity",1),c.append("text").attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("x",-5).attr("y",-5).attr("text-anchor","end").attr("alignment-baseline","bottom").attr("filter","url(#highlightText)").attr("fill",x=>n(x.label)).text(x=>x.label+":  "+_.formatter(x.y)),c.append("circle").attr("r",3).attr("fill",x=>n(x.label)),c},s=>{s.attr("transform",c=>`translate(${v(c.x)}, ${b(c.y)})`).select("text").text(c=>c.label+":  "+_.formatter(c.y))},s=>s.attr("opacity",1).transition().duration(200).attr("opacity",0).remove())}).on("pointerleave",a=>{d(p.value).selectAll(".tooltipData").transition().duration(500).attr("opacity",0).remove()}).on("touchstart",a=>a.preventDefault()),d(f.value).selectAll(".line").data(_.data,a=>a.label).join(a=>a.insert("path",":first-child").attr("class","line").attr("fill","none").attr("stroke",l=>n(l.label)).attr("stroke-width",0).attr("d",l=>T(l.values)).transition().duration(500).attr("d",l=>A(l.values)).attr("stroke-width",1.5),a=>a.transition().duration(500).attrTween("d",function(l){var u=d(this).attr("d"),m=A(l.values);return W(u,m)}),a=>a.transition(500).duration(500).attr("d",l=>T(l.values)).remove()),d(h.value).selectAll(".legend").data(_.data,a=>a.label+(a.extra_label||"")).join(a=>{const l=a.append("g").attr("class","legend");return l.attr("opacity",0).attr("transform",(u,m)=>`translate(100, ${m*20})`).transition().duration(500).attr("transform",(u,m)=>`translate(10, ${m*20})`).attr("opacity",1),l.append("text").attr("font-size","12px").attr("font-weight","bold").attr("fill",u=>n(u.label)).text(u=>u.label+(u.extra_label||"")),l},a=>(a.transition().duration(1e3).attr("transform",(l,u)=>`translate(10, ${u*20})`).attr("opacity",1),a),a=>{a.transition().duration(500).attr("transform",(l,u)=>`translate(100, ${u*20})`).attr("opacity",0).remove()})};return R(()=>{M(),new ResizeObserver(M).observe(e.value)}),Z(()=>_.data,M),(i,k)=>(j(),z("div",{class:"container",ref_key:"container",ref:e,align:"center"},[(j(),z("svg",null,[g("g",{ref_key:"content",ref:f},[g("g",{ref_key:"tooltip",ref:p},null,512),g("g",{ref_key:"legend",ref:h},null,512)],512),g("g",{ref_key:"xAxis",ref:o},null,512),g("g",{ref_key:"yAxis",ref:r},null,512),k[0]||(k[0]=q('<filter id="highlightText" x="0" y="0" width="100%" height="100%" data-v-303db5c8><feMorphology in="SourceAlpha" result="dilated" operator="dilate" radius="2" data-v-303db5c8></feMorphology><feFlood flood-color="white" result="glow" data-v-303db5c8></feFlood><feComposite in="glow" in2="dilated" operator="in" result="softGlow" data-v-303db5c8></feComposite><feMerge data-v-303db5c8><feMergeNode in="softGlow" data-v-303db5c8></feMergeNode><feMergeNode in="SourceGraphic" data-v-303db5c8></feMergeNode></feMerge></filter>',1))]))],512))}}),dt=tt(rt,[["__scopeId","data-v-303db5c8"]]);export{dt as _,at as m};
