import{_ as de}from"./S-oeU3K-.js";import{f as te,y as Q,z as me,h as c,r as g,o as S,p as R,w as r,a as l,t as v,c as B,F as W,k as H,n as G,d as p,l as fe,j as t,g as _e,q as ge,A as ee,K as ve,i as f,b as a,v as b}from"./CIIwfncC.js";import{_ as be}from"./BIz80n36.js";import{_ as he}from"./D3ms4flo.js";import{_ as ye}from"./DlAUqK2U.js";import"./DfeVyLnx.js";import"./Br5iDS7E.js";import"./Dp_3OYB3.js";import"./BeACrgm2.js";import"./BnJ91Bvx.js";import"./D2nGpDRe.js";import"./DKbKBQE1.js";import"./CNzZi2nf.js";import"./rlX7cRMw.js";import"./Drloq0xg.js";import"./ntdiYfc-.js";const we=[{name:"C++ file",description:"The number of C++ files.",script:"git ls-files -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"file"},{name:"C++ line",description:"The number of lines in C++ lines, omitting blank/comment/macro.",script:"python3 ../../scripts/cpp_lines.py",file:"line"},{name:"raw_ptr",description:"The number of raw_ptr<T>",script:"git grep -c 'raw_ptr<' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"raw_ptr",tags:["MiraclePtr"]},{name:"raw_ref",description:"The number of raw_ref<T>",script:"git grep -c 'raw_ref<' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"raw_ref",tags:["MiraclePtr"]},{name:"RAW_PTR_EXCLUSION",description:"The number of RAW_PTR_EXCLUSION",script:"git grep -c 'RAW_PTR_EXCLUSION ' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"raw_ptr_exclusion",tags:["MiraclePtr"]},{name:"DanglingUntriaged",description:"The number of DanglingUntriaged",script:"git grep -c 'DanglingUntriaged' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"dangling_untriaged",tags:["MiraclePtr"]},{name:"AllowPtrArithmetic",description:"The number of AllowPtrArithmetic",script:"git grep -c 'AllowPtrArithmetic' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"allow_ptr_arithmetic",tags:["MiraclePtr"]},{name:"ContainerExperimental",description:"The number of VectorExperimental, SetExperimental, CtnExperimental",script:`git grep -cE "(Vector|Set|Ctn)Experimental" -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'`,file:"ctrn_expr",tags:["MiraclePtr"]},{name:"Unsafe Buffer Usage Lines",description:"The number of lines with UNSAFE_BUFFER_USAGE, calculated by a script.",script:"python3 ../../scripts/warn_unsafe_buffer_usage_lines.py",file:"lines_unsafe_buffer_usage",tags:["Spanification"]},{name:"allow_unsafe_buffers",description:"The number of files with allow_unsafe_buffers",script:"git grep -c 'allow_unsafe_buffers' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"allow_unsafe_buffers",tags:["Spanification"]},{name:"UNSAFE_BUFFER_USAGE",description:"The occurrences of UNSAFE_BUFFER_USAGE",script:"git grep -c 'UNSAFE_BUFFER_USAGE' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"unsafe_buffer_usage",tags:["Spanification"]},{name:"UNSAFE_BUFFERS",description:"The occurrences of UNSAFE_BUFFERS(...)",script:"git grep -c 'UNSAFE_BUFFERS(' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"unsafe_buffers",tags:["Spanification"]},{name:"UNSAFE_TODO",description:"The occurrences of UNSAFE_TODO(...)",script:"git grep -c 'UNSAFE_TODO(' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"unsafe_todo",tags:["Spanification"]},{name:"base::Unretained",description:"The occurrences of base::Unretained",script:"git grep -c 'base::Unretained' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"base_unretained",tags:["Memory Safety"]},{name:"Browser Modularization",description:"The number of files required for browser modularization",script:"git grep -c -E 'TestBrowserWindow|BrowserWithTestWindowTest|TestWithBrowserView|CreateBrowserWithTestWindowForParams' -- ':!*ash*' ':!*chromeos*' '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"browser_modularization",tags:["Browser Modularization"]},{name:"TODO",description:"The number of TODO",script:"git grep -c 'TODO' -- '*.h' '*.hpp' '*.cc' '*.cpp' '*.c'",file:"todo",tags:["Misc"]}],z={metrics:we},Te={class:"mr-2 is-size-6"},xe={style:{"font-style":"italic"}},Ue=te({__name:"TreemapInput",props:Q({placeholder:{type:String,required:!1,default:"Type to filter"}},{value:{},valueModifiers:{}}),emits:Q(["input"],["update:value"]),setup(L,{emit:E}){const n=me(L,"value"),$=c(null),h=E,N=c(z.metrics),y=i=>{N.value=z.metrics.filter(u=>u.length===0?!0:u.name.toLowerCase().includes(i.toLowerCase())||u.description.toLowerCase().includes(i.toLowerCase())||u.file.toLowerCase().includes(i.toLowerCase()))},D=i=>{h("input",i)};return(i,u)=>{const _=g("b-tag"),w=g("b-taginput");return S(),R(w,{ref_key:"input",ref:$,modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=d=>n.value=d),onInput:D,onTyping:y,data:t(N),"allow-new":!1,autocomplete:"",icon:"label",field:"name",placeholder:L.placeholder,type:"is-primary","open-on-focus":""},{default:r(d=>[l("strong",Te,v(d.option.name),1),d.option.tags?(S(!0),B(W,{key:0},H(d.option.tags,x=>(S(),R(_,{key:x,style:G({color:"white",backgroundColor:i.$color(x)})},{default:r(()=>[p(v(x),1)]),_:2},1032,["style"]))),128)):fe("",!0),l("p",xe,v(d.option.description),1)]),header:r(()=>u[1]||(u[1]=[l("div",{class:"content"},[l("strong",{class:"is-size-4"},"Metrics")],-1)])),_:1},8,["modelValue","data","placeholder"])}}}),Se={class:"m-5"},Ee={class:"section"},Ce={class:"section content"},Ve={class:"section content"},ke={class:"fraction"},Fe={class:"fraction"},Me={class:"numerator"},Ae={class:"denominator"},qe=te({__name:"treemap",setup(L){const E=c(null),n=_e(),$=ge(),h=c([z.metrics[7]]);n.query.field_color&&(h.value=n.query.field_color.split(",").map(s=>z.metrics.find(e=>e.file===s)));const N=ee(()=>h.value.map(s=>s.file)),y=c([z.metrics[0]]);n.query.field_size&&(y.value=n.query.field_size.split(",").map(s=>z.metrics.find(e=>e.file===s)));const D=ee(()=>y.value.map(s=>s.file)),i=c([new Date("2020-01-01"),new Date]);n.query.dates&&(i.value=n.query.dates.split(",").map(s=>new Date(s)));const u=c("Red");n.query.colormap&&(u.value=n.query.colormap);const _=c([]);n.query.path&&(_.value=n.query.path.split(","));const w=c(0);n.query.colormapMin&&(w.value=parseFloat(n.query.colormapMin));const d=c(.12);n.query.colormapMax&&(d.value=parseFloat(n.query.colormapMax));const x=c(["chromium"]);n.query.repositories&&(x.value=n.query.repositories.split(","));const C=c(!0);n.query.history_color=="0"&&(C.value=!1);const V=c(!1);n.query.history_size=="1"&&(V.value=!0);const k=c(!1);n.query.exclude_test!==void 0&&(k.value=!0);const F=c(!1);n.query.exclude_third_party!==void 0&&(F.value=!0);const T=c(!1),M=c(1),{$color_map:X,$GetColormapGradient:P}=ve(),oe=c(Object.keys(X)),le=()=>{switch(M.value){case 1:M.value=2;break;case 2:M.value=5;break;case 5:M.value=10;break;case 10:M.value=1;break}},m=(s,e)=>{const A={colormap:u.value,colormapMax:d.value,colormapMin:w.value,field_color:h.value.map(U=>U.file).join(","),field_size:y.value.map(U=>U.file).join(","),path:_.value.join(","),repositories:x.value.join(","),dates:i.value.map(U=>U.toISOString().split("T")[0]).join(",")};C.value===!1&&(A.history_color="0"),V.value===!0&&(A.history_size="1"),k.value===!0&&(A.exclude_test=null),F.value===!0&&(A.exclude_third_party=null),$.push({query:A})},ae=(s,e)=>s.length<=e?s:s.slice(0,e-1)+"â€¦";f(x,m),f(u,m),f(d,m),f(w,m),f(h,m),f(y,m),f(_,m),f(i,m),f(C,m),f(V,m),f(k,m),f(F,m);const J=()=>{const s=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);document.documentElement.dataset.scrolltop=window.scrollY>100?"1":"0",document.documentElement.dataset.scrollbottom=s-window.scrollY>1e3?"1":"0"};J(),document.addEventListener("scroll",J,{passive:!0});const j=async()=>{if(i.value[1]>new Date&&(T.value=!1),T.value){const s=i.value[1].getTime()+M.value*7*24*60*60*1e3;i.value=[i.value[0],new Date(s)]}};f(T,()=>{T.value&&j()});const ne=()=>{T.value=!T.value,T.value&&j()};return console.log(X.Viridis(.5)),console.log(P("Viridis")),(s,e)=>{const A=de,U=Ue,O=g("b-checkbox"),I=g("b-button"),ie=g("b-dropdown-item"),re=g("b-dropdown"),q=g("b-field"),Y=g("b-input"),K=g("b-breadcrumb-item"),se=g("b-breadcrumb"),ue=be,pe=he,ce=g("b-icon");return S(),B("div",null,[a(A),l("div",Se,[a(q,{group:"","group-multiline":""},{default:r(()=>[a(U,{value:t(h),"onUpdate:value":e[0]||(e[0]=o=>b(h)?h.value=o:null),placeholder:"color/numerator"},null,8,["value"]),a(O,{modelValue:t(C),"onUpdate:modelValue":e[1]||(e[1]=o=>b(C)?C.value=o:null),class:"ml-4"},null,8,["modelValue"]),a(U,{value:t(y),"onUpdate:value":e[2]||(e[2]=o=>b(y)?y.value=o:null),placeholder:"size/denominator"},null,8,["value"]),a(O,{modelValue:t(V),"onUpdate:modelValue":e[3]||(e[3]=o=>b(V)?V.value=o:null),class:"ml-4"},null,8,["modelValue"]),a(q,{expanded:"",class:"mr-2",label:"Colormap","label-position":"on-border"},{default:r(()=>[a(re,{modelValue:t(u),"onUpdate:modelValue":e[4]||(e[4]=o=>b(u)?u.value=o:null),expanded:"",trap:"",triggers:["hover"],scrollable:"","max-height":"300px"},{trigger:r(({active:o})=>[a(I,{type:"is-ghost","icon-right":o?"menu-up":"menu-down"},{default:r(()=>[p(v(s.option)+" ",1),l("span",{class:"color-swatch",style:G({background:t(P)(t(u))})},null,4),p(" "+v(t(u)),1)]),_:2},1032,["icon-right"])]),default:r(()=>[(S(!0),B(W,null,H(t(oe),o=>(S(),R(ie,{key:o,value:o},{default:r(()=>[l("span",{class:"color-swatch",style:G({background:t(P)(o,10)})},null,4),p(" "+v(ae(o,5)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(q,{class:"mr-2",label:"Min","label-position":"on-border"},{default:r(()=>[a(Y,{modelValue:t(w),"onUpdate:modelValue":e[5]||(e[5]=o=>b(w)?w.value=o:null),placeholder:"Min"},null,8,["modelValue"])]),_:1}),a(q,{class:"mr-2",label:"Max","label-position":"on-border"},{default:r(()=>[a(Y,{modelValue:t(d),"onUpdate:modelValue":e[6]||(e[6]=o=>b(d)?d.value=o:null),placeholder:"Max"},null,8,["modelValue"])]),_:1}),a(O,{modelValue:t(k),"onUpdate:modelValue":e[7]||(e[7]=o=>b(k)?k.value=o:null),class:"ml-4"},{default:r(()=>e[17]||(e[17]=[p(" Exclude tests ")])),_:1},8,["modelValue"]),a(O,{modelValue:t(F),"onUpdate:modelValue":e[8]||(e[8]=o=>b(F)?F.value=o:null),class:"ml-4"},{default:r(()=>e[18]||(e[18]=[p(" Exclude third parties ")])),_:1},8,["modelValue"])]),_:1}),a(se,{align:"is-left"},{default:r(()=>[a(K,{tag:"a",onClick:e[9]||(e[9]=o=>_.value=[])},{default:r(()=>e[19]||(e[19]=[p(" <root> ")])),_:1}),(S(!0),B(W,null,H(t(_),(o,Z)=>(S(),R(K,{tag:"a",key:Z,onClick:ze=>_.value=t(_).slice(0,Z+1)},{default:r(()=>[p(v(o),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),a(ue,{repositories:t(x),path:t(_),field_color:t(N),field_size:t(D),colormapMin:t(w),colormapMax:t(d),colormap:t(u),dates:t(i),animate:t(T),history_color:t(C),history_size:t(V),exclude_test:t(k),exclude_third_party:t(F),onZoomin:e[10]||(e[10]=o=>{t(_).push(o),m()}),onAnimationend:e[11]||(e[11]=o=>j()),ref_key:"treemap",ref:E},null,8,["repositories","path","field_color","field_size","colormapMin","colormapMax","colormap","dates","animate","history_color","history_size","exclude_test","exclude_third_party"]),l("div",Ee,[a(q,{grouped:""},{default:r(()=>[a(q,{expanded:""},{default:r(()=>[a(pe,{modelValue:t(i),"onUpdate:modelValue":e[12]||(e[12]=o=>b(i)?i.value=o:null)},null,8,["modelValue"])]),_:1}),a(q,{grouped:""},{default:r(()=>[a(I,{class:"ml-5",onClick:ne,disabled:t(i)[1].getTime()>new Date().getTime()-1e8},{default:r(()=>[a(ce,{icon:t(T)?"pause":"play",size:"is-small"},null,8,["icon"])]),_:1},8,["disabled"]),a(I,{disabled:t(i)[1].getTime()>new Date().getTime()-1e8,onClick:le},{default:r(()=>[p(" x"+v(t(M)),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),l("section",Ce,[e[24]||(e[24]=l("h2",{class:"title is-5"}," Download data: ",-1)),l("ul",null,[l("li",null,[e[20]||(e[20]=p("Temporal data: ")),l("a",{onClick:e[13]||(e[13]=o=>t(E).download("temporal_json"))}," JSON "),e[21]||(e[21]=p(", ")),l("a",{onClick:e[14]||(e[14]=o=>t(E).download("temporal_csv"))}," CSV ")]),l("li",null,[e[22]||(e[22]=p("Spatial data: ")),l("a",{onClick:e[15]||(e[15]=o=>t(E).download("spatial_json"))}," JSON "),e[23]||(e[23]=p(", ")),l("a",{onClick:e[16]||(e[16]=o=>t(E).download("spatial_csv"))}," CSV ")])])]),l("section",Ve,[e[27]||(e[27]=l("h2",{class:"title is-5"}," How to read the treemap: ",-1)),l("ul",null,[l("li",null,[e[25]||(e[25]=p("The area of rectangle is proportional to: ")),l("span",ke,v(t(D).join(" + ")),1)]),l("li",null,[e[26]||(e[26]=p(" The color is the proportional to: ")),l("div",Fe,[l("span",Me,v(t(N).join(" + ")),1),l("span",Ae,v(t(D).join(" + ")),1)])])]),e[28]||(e[28]=l("h3",{class:"title is-5"}," Datasets ",-1)),e[29]||(e[29]=l("p",{class:"mt-2"},[p(" Content is updated "),l("strong",null,"weekly"),p(". "),l("br"),p(" To add a new dataset, please edit the "),l("a",{href:"https://github.com/ArthurSonzogni/ChromeCommitTracker/blob/main/treemap.yaml"},[l("code",null,"treemap.yaml"),p(" file. ")])],-1))])])}}}),Ke=ye(qe,[["__scopeId","data-v-0cc20f37"]]);export{Ke as default};
