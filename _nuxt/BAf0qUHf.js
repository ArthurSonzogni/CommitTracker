import{r as j}from"./FOedhIC0.js";import{f as F,y as S,h as x,z,s as h,K as E,i as V,r as $,o as i,p as b,w as B,c,F as D,k as q,t as v,j as P}from"./CIIwfncC.js";const U={key:0},A={key:1,style:{color:"blue"}},T=F({__name:"DevelopersInput",props:S({size:{type:String,required:!1},allowUsername:{type:Boolean,default:!0},allowEmail:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const l=x(null),r=z(u,"modelValue"),p=u,f=h([]),m=h([]),w=e=>async()=>{const t=a=>fetch(a).then(d=>d.json()),o=a=>t(`/data/${a.dirname}/${e}`),n=(await Promise.all(j.map(o))).reduce((a,d)=>a.concat(d),[]);return new Set(n)},g=w("usernames.json"),k=w("emails.json");new Promise(async()=>{let e=new Set;if(p.allowUsername){const o=await g();e=e.union(o)}if(p.allowEmail){const o=await k();e=e.union(o)}const t=Array.from(e);f.value=t,r.value.filter(o=>t.includes(o))});const _=e=>{if(e==null||e.length<=2){m.value=[];return}e=e.trim().toLowerCase();const t=s=>s.toLowerCase().indexOf(e)==0,o=(s,n)=>s.toLowerCase().indexOf(e)-n.toLowerCase().indexOf(e);m.value=f.value.filter(t).slice(0,1e3).sort(o).slice(0,10)},{$color:L}=E(),y=async()=>{await new Promise(t=>setTimeout(t,100));let e=0;for(const t of l.value.$el.querySelectorAll(".tag"))t.style.backgroundColor=L(r.value[e]),++e},C=async()=>{for(;l.value==null;)await new Promise(e=>setTimeout(e,100));l.value.$el.querySelector("input").addEventListener("keydown",e=>{if(console.log("keydown",e),e.key=="Enter"){const t=l.value.$el.querySelector(".dropdown-item");t&&t.click()}})};return V(r,y),y(),C(),(e,t)=>{const o=$("b-taginput");return i(),b(o,{ref_key:"input",ref:l,modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=s=>r.value=s),onTyping:_,data:P(m),"allow-new":!1,autocomplete:"",icon:"label",field:"this",placeholder:"developer username",type:"is-primary",size:u.size||"is-medium","open-on-focus":""},{default:B(s=>[(i(!0),c(D,null,q(s.option.split("@"),(n,a)=>(i(),c("span",{key:a},[a==0?(i(),c("span",U,v(n),1)):(i(),c("strong",A," (@"+v(n)+") ",1))]))),128))]),_:1},8,["modelValue","data","size"])}}});export{T as _};
