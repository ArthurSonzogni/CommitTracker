import{_ as D}from"./S-oeU3K-.js";import{_ as R}from"./DeENtvZi.js";import{_ as q}from"./-VIJyViA.js";import{_ as b}from"./D3ms4flo.js";import{f as j,g as B,q as C,s as y,h as g,i as h,B as k,r as M,o as N,c as S,b as m,a as u,j as f,v as x,w as T}from"./CIIwfncC.js";import"./DlAUqK2U.js";import"./FOedhIC0.js";import"./CNzZi2nf.js";import"./BeACrgm2.js";import"./BySFM-T0.js";import"./Dp_3OYB3.js";import"./BnJ91Bvx.js";import"./D2nGpDRe.js";const z={class:"section"},A={class:"container"},P={class:"section sticky bottom"},Y=j({__name:"pulse",setup(U){const p=B(),V=C();y([]);const v=y([]),s=g([new Date("2000-01-01"),new Date]);if(p.query.dates)try{s.value=p.query.dates.split(",").map(l=>new Date(l))}catch(l){console.error(l)}const n=g(["chromium"]);p.query.repositories&&(n.value=p.query.repositories.split(","));const _=async()=>{V.push({query:{repositories:n.value.join(","),dates:s.value.map(e=>e.toISOString()).join(",")}});const l=await Promise.all(n.value.map(e=>fetch(`/data/${e}/commits_per_hour.json`))),t=await Promise.all(l.map(e=>e.json()));let r=new Date(t.map(e=>e.startDate).reduce((e,o)=>e<o?e:o));const c=Math.max(...t.map(e=>e.commits.length)),d=t.map(e=>{const o=new Array(c).fill(0),i=c-e.commits.length;for(let a=0;a<e.commits.length;a++)o[a+i]=e.commits[a];return o}).map(e=>e.filter((o,i)=>{const a=new Date(r.getTime()+i*1e3*60*60);return a>=s.value[0]&&a<=s.value[1]}));s.value[0]>r&&(r=s.value[0]),v.value=d.map((e,o)=>({label:n.value[o],values:e.map((i,a)=>({x:new Date(r.getTime()+a*1e3*60*60),y:i}))}))};return h(n,_),h(s,_),k(_),(l,t)=>{const r=D,c=R,w=q,d=b,e=M("b-field");return N(),S("div",null,[m(r),u("section",z,[u("div",A,[t[2]||(t[2]=u("h1",{class:"title"},"Repository commits",-1)),t[3]||(t[3]=u("strong",null,"Repositories:",-1)),m(c,{modelValue:f(n),"onUpdate:modelValue":t[0]||(t[0]=o=>x(n)?n.value=o:null),size:"medium",allowMultiple:!0,allowAll:!0},null,8,["modelValue"]),m(w,{data:f(v)},null,8,["data"])])]),u("section",P,[m(e,{expanded:""},{default:T(()=>[m(d,{modelValue:f(s),"onUpdate:modelValue":t[1]||(t[1]=o=>x(s)?s.value=o:null)},null,8,["modelValue"])]),_:1})])])}}});export{Y as default};
